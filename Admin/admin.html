<html>
<head>
<title>Admin Panel</title>
<script src="https://www.gstatic.com/firebasejs/5.8.2/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAq1DBBz6i4irkVOQOK1nsNKDOSLYbytR0",
    authDomain: "fir-web-464fc.firebaseapp.com",
    databaseURL: "https://fir-web-464fc.firebaseio.com",
    projectId: "fir-web-464fc",
    storageBucket: "fir-web-464fc.appspot.com",
    messagingSenderId: "321941519487"
  };
  firebase.initializeApp(config);
</script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>


</head>

<body>
 

  <table id="tbl_news_list" class="table table-striped">
      <tr>
          
          <td>News Title</td>
          <td>News Description</td>
          <td>News Author</td>
          <td>Delete</td>
          <td>Update</td>
      </tr>

  </table>

  <script>
      var tblNews = document.getElementById('tbl_news_list');
      var databaseRef = firebase.database().ref('news/');
      var rowIndex = 1;

        
      
      databaseRef.once('value', function(snapshot) {
        snapshot.forEach(function(childSnapshot) {
            var childKey = childSnapshot.key;
            var childData = childSnapshot.val();

            var row = tblNews.insertRow(rowIndex);
            
            var CellTitle = row.insertCell(0);
            var CellDescription = row.insertCell(1);
            var CellAuthor = row.insertCell(2);
            var CellDelete = row.insertCell(3);
            var CellUpdate = row.insertCell(4);
            
            

            //news title textbox
            var TitleBox = document.createElement("input");
            TitleBox.value = childData.news_title;
            CellTitle.appendChild(TitleBox);

            //news description textbox
            var DescriptionBox = document.createElement("input");
            DescriptionBox.value = childData.news_description;
            CellDescription.appendChild(DescriptionBox);

            //news author
            CellAuthor.appendChild(document.createTextNode(childData.news_author));

            //Delete button
            var DeleteBtn = document.createElement("BUTTON");
            var t = document.createTextNode("Delete");
            DeleteBtn.appendChild(t);
            CellDelete.appendChild(DeleteBtn);
            DeleteBtn.addEventListener('click',function ()
            {
 
                firebase.database().ref().child('/news/' + childKey).remove();
                alert("News Deleted.!");           
                ReloadPage();
            //validation code to see State field is mandatory.  
            }  ); 

            //Update button
            var UpdateBtn = document.createElement("BUTTON");
            var t = document.createTextNode("Update");
            UpdateBtn.appendChild(t);
            CellUpdate.appendChild(UpdateBtn);
            UpdateBtn.addEventListener('click',function ()
            {
 
                news_id=childKey;
                news_title=TitleBox.value;
                news_description=DescriptionBox.value;
                news_author=childData.news_author;

                var data = {
                news_id: news_id,
                news_title: news_title,
                news_description: news_description,
                news_author: news_author
                }
            
                var updates = {};
                updates['/news/' + news_id] = data;
                firebase.database().ref().update(updates);

                alert("News Updated.!");
                ReloadPage();
            //validation code to see State field is mandatory.  
            }  );

            
            rowIndex = rowIndex + 1;
        // ...
        });
        });

      

      


      function ReloadPage(){
            window.location.reload();
      }
  
  </script>

</body>

</html>